<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - Car Service Logbook</title>
    <link rel="stylesheet" href="../css/styles.css">
    <link rel="stylesheet" href="../css/modern-enhancements.css">
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="nav-brand">üîß Car Service Logbook</div>
            <ul class="nav-menu">
                <li><a href="./home.html" class="nav-link">üè† Home</a></li>
                <li><a href="./vehicles.html" class="nav-link">üöó Vehicles</a></li>
                <li><a href="./services.html" class="nav-link">üîß Services</a></li>
                <li><a href="./reports.html" class="nav-link">üìä Reports</a></li>
                <li><a href="./profile.html" class="nav-link active">üë§ Profile</a></li>
            </ul>
        </nav>
    </header>

    <main>
        <section class="profile-section">
            <div class="page-header">
                <h1>User Profile</h1>
            </div>
            
            <div id="auth-container">
            </div>
        </section>
    </main>

    <footer>
        <p>&copy; 2023 Car Service Logbook. All rights reserved.</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const isLoggedIn = localStorage.getItem('isLoggedIn') === 'true';
            const authContainer = document.getElementById('auth-container');
            
            if (isLoggedIn) {
                const userEmail = localStorage.getItem('userEmail') || 'user@example.com';
                authContainer.innerHTML = `
                    <div class="profile-card">
                        <div class="profile-header">
                            <div class="profile-avatar">
                                <span>${userEmail.charAt(0).toUpperCase()}</span>
                            </div>
                            <h2>Welcome, ${userEmail}</h2>
                        </div>
                        
                        <div class="profile-details">
                            <div class="detail-item">
                                <strong>Email:</strong>
                                <span>${userEmail}</span>
                            </div>
                            
                            <div class="detail-item">
                                <strong>Account Status:</strong>
                                <span>Active</span>
                            </div>
                            
                            <div class="detail-item">
                                <strong>Member Since:</strong>
                                <span>${new Date().toLocaleDateString()}</span>
                            </div>
                        </div>
                        
                        <div class="profile-actions">
                            <button id="logout-btn" class="btn-primary">Logout</button>
                            <button id="delete-account-btn" class="btn-delete">Delete Account</button>
                        </div>
                    </div>
                `;
                
                document.getElementById('logout-btn').addEventListener('click', function() {
                    localStorage.removeItem('isLoggedIn');
                    localStorage.removeItem('userEmail');
                    window.location.reload();
                });
                
                document.getElementById('delete-account-btn').addEventListener('click', function() {
                    if (confirm('Are you sure you want to delete your account? This action cannot be undone.')) {
                        localStorage.removeItem('isLoggedIn');
                        localStorage.removeItem('userEmail');
                        localStorage.removeItem('users');
                        localStorage.removeItem('cars');
                        localStorage.removeItem('services');
                        
                        alert('Account deleted successfully.');
                        window.location.href = './home.html';
                    }
                });
            } else {
                authContainer.innerHTML = `
                    <div class="auth-tabs">
                        <div class="tab-buttons">
                            <button id="login-tab" class="tab-btn active">Login</button>
                            <button id="signup-tab" class="tab-btn">Sign Up</button>
                        </div>
                        
                        <div class="tab-content">
                            <div id="login-tab-content" class="tab-pane active">
                                <form id="login-form" class="auth-form">
                                    <div class="form-group">
                                        <label for="login-email">Email Address</label>
                                        <input type="email" id="login-email" placeholder="Enter your email" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="login-password">Password</label>
                                        <input type="password" id="login-password" placeholder="Enter your password" required>
                                    </div>
                                    
                                    <div class="form-group checkbox-group">
                                        <input type="checkbox" id="remember-me">
                                        <label for="remember-me">Remember me</label>
                                    </div>
                                    
                                    <button type="submit" class="btn-primary auth-btn">Login</button>
                                    
                                    <div class="auth-links">
                                        <a href="#">Forgot Password?</a>
                                    </div>
                                </form>
                            </div>
                            
                            <div id="signup-tab-content" class="tab-pane">
                                <form id="signup-form" class="auth-form">
                                    <div class="form-group">
                                        <label for="signup-name">Full Name</label>
                                        <input type="text" id="signup-name" placeholder="Enter your full name" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="signup-email">Email Address</label>
                                        <input type="email" id="signup-email" placeholder="Enter your email" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="signup-password">Password</label>
                                        <input type="password" id="signup-password" placeholder="Create a password" required>
                                    </div>
                                    
                                    <div class="form-group">
                                        <label for="signup-confirm-password">Confirm Password</label>
                                        <input type="password" id="signup-confirm-password" placeholder="Confirm your password" required>
                                    </div>
                                    
                                    <div class="form-group checkbox-group">
                                        <input type="checkbox" id="terms" required>
                                        <label for="terms">I agree to the <a href="#">Terms of Service</a> and <a href="#">Privacy Policy</a></label>
                                    </div>
                                    
                                    <button type="submit" class="btn-primary auth-btn">Sign Up</button>
                                </form>
                            </div>
                        </div>
                    </div>
                `;
                
                document.getElementById('login-tab').addEventListener('click', function() {
                    document.getElementById('login-tab').classList.add('active');
                    document.getElementById('signup-tab').classList.remove('active');
                    document.getElementById('login-tab-content').classList.add('active');
                    document.getElementById('signup-tab-content').classList.remove('active');
                });
                
                document.getElementById('signup-tab').addEventListener('click', function() {
                    document.getElementById('signup-tab').classList.add('active');
                    document.getElementById('login-tab').classList.remove('active');
                    document.getElementById('signup-tab-content').classList.add('active');
                    document.getElementById('login-tab-content').classList.remove('active');
                });
                
                document.getElementById('login-form').addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const email = document.getElementById('login-email').value;
                    const password = document.getElementById('login-password').value;
                    
                    if (email && password) {
                        const users = JSON.parse(localStorage.getItem('users')) || [];
                        const user = users.find(u => u.email === email && u.password === password);
                        
                        if (user) {
                            localStorage.setItem('isLoggedIn', 'true');
                            localStorage.setItem('userEmail', email);
                            
                            window.location.reload();
                        } else {
                            alert('Invalid email or password!');
                        }
                    } else {
                        alert('Please fill in all fields');
                    }
                });
                
                document.getElementById('signup-form').addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const name = document.getElementById('signup-name').value;
                    const email = document.getElementById('signup-email').value;
                    const password = document.getElementById('signup-password').value;
                    const confirmPassword = document.getElementById('signup-confirm-password').value;
                    
                    if (password !== confirmPassword) {
                        alert('Passwords do not match!');
                        return;
                    }
                    
                    if (name && email && password) {
                        const users = JSON.parse(localStorage.getItem('users')) || [];
                        const userExists = users.some(user => user.email === email);
                        
                        if (userExists) {
                            alert('An account with this email already exists!');
                            return;
                        }
                        
                        users.push({
                            id: Date.now(),
                            name: name,
                            email: email,
                            password: password
                        });
                        
                        localStorage.setItem('users', JSON.stringify(users));
                        localStorage.setItem('isLoggedIn', 'true');
                        localStorage.setItem('userEmail', email);
                        
                        alert('Account created successfully!');
                        window.location.reload();
                    } else {
                        alert('Please fill in all fields');
                    }
                });
            }
        });
    </script>
</body>
</html>